---
typora-root-url: ..\..\graphs\photos
typora-copy-images-to: ..\..\graphs\photos
---

## 加密解密概述

### 概念

加密是以某种特殊的方法改变明文的文件或数据的内容使其成为密文的过程，而解密则使用与加密相同或不同的方法将密文恢复成原有数据，是加密的逆过程。未授权的用户由于不知道解密的方法，即使获得了密文也无法从中获取有意义的信息，直接读取密文只能获得一堆乱码，所以加密后的数据可以进行安全地存储或传输。

加密解密技术包括两个元素：算法（algorithm）和密钥（secret key）。算法是规定如何进行加密和解密的一组规则，用来将明文与一串特殊字符结合生成密文（或使用一串字符将密文恢复成原来的明文）；而密钥就是用来对数据进行编码和解码的那一串特殊字符。如果将加密解密比作上锁解锁的过程，则算法可以理解为上锁解锁的方法（插入钥匙后如何旋转），而密钥就可以看作是上锁解锁的钥匙（生活中上锁解锁时的钥匙通常是同一把钥匙，但加密和解密可以用不同的密钥，详见加密类型部分的介绍）。

加密之所以安全，绝非因不知道加密解密的算法，而是加密的密钥是绝对隐藏的，现在流行的RSA和AES加密算法都是完全公开的，一方取得已加密的数据，若没有加密的密钥，就算知道加密算法也不能打开被加密的保护信息。单单隐蔽加密算法以保护信息，在学界和业界已有相当讨论，一般认为是不够安全的。公开的加密算法是经过长年累月攻击测试的，比隐蔽的加密算法要安全得多。

### 加密算法类型

密码学在加密算法上大体可分为单向加密算法、对称加密算法、非对称加密算法三大类。

MD5、SHA 算法是单向加密算法的代表，单向加密算法是数据完整性验证的常用算法。DES 算法是典型的对称加密算法的代表，对称加密算法是数据存储加密的常用算法。RSA 算法是典型的非对称加密算法的代表，非对称加密算法是数据传输加密的常用算法。对称加密算法也可以用做数据传输加密，但非对称加密算法在密钥管理方面更有优势。相对于对称加密算祛而言，非对称加密算法在安全级别上等级更高，但非对称加密算法在时间效率上远不如对称加密算法。

#### 单向加密



#### 对称加密

对称加密也称为单密钥加密，双方采用相同的密钥进行加密和解密（当然这个密钥是需要对外保密的）。

![377adab44aed2e736ab19f6a8401a18b87d6fa18](/377adab44aed2e736ab19f6a8401a18b87d6fa18.jpg)

对称加密算法的优点是**算法公开、计算量小、加密速度快、加密效率高**。对称加密算法的缺点是在数据传送前，发送方和接收方必须商定好秘钥，然后使双方都能保存好秘钥。其次如果一方的秘钥被泄露，那么加密信息也就不安全了。另外，每对用户每次使用对称加密算法时，都需要使用其他人不知道的唯一秘钥，这会使得收、发双方所拥有的钥匙数量巨大，**密钥管理成为双方的负担**。如何把密钥安全地传递到解密者手上也是必须要解决的问题。

对称加密的密钥长度从40bits到168bits。常用的对称加密算法有DES、3DES、TDEA、Blowfish、RC系列（RC2、RC4、RC5）、IDEA、CAST、SKIPJACK、AES等。

#### 非对称加密

非对称加密存在两中密钥，一种是公共密钥（public key，是一个可以对外公开的密钥值），一种是私人密钥（private key，对外保密）。发送方发送信息之前使用公钥加密信息，接收方则使用私钥解密收到的密文。只有唯一的私钥可以解密被公钥加密的信息，这就在技术上保证了这条信息只有发送方和接收方才能解读——因为只有接收方拥有对应的私钥。 

![1b4c510fd9f9d72a79ac165bd72a2834359bbbaf](/1b4c510fd9f9d72a79ac165bd72a2834359bbbaf.jpg)

如上图所示，甲乙之间使用非对称加密的方式完成了重要信息的安全传输。

1. 乙方生成一对密钥（公钥和私钥）并将公钥向其它方公开。
2. 得到该公钥的甲方使用该密钥对机密信息进行加密后再发送给乙方。
3. 乙方再用自己保存的另一把专用密钥（私钥）对加密后的信息进行解密。乙方只能用其专用密钥（私钥）解密由对应的公钥加密后的信息。

在传输过程中，即使攻击者截获了传输的密文，并得到了乙的公钥，也无法破解密文，因为只有乙的私钥才能解密密文。
同样，如果乙要回复加密信息给甲，那么需要甲先公布甲的公钥给乙用于加密，甲自己保存甲的私钥用于解密。

非对称加密与对称加密相比，其安全性更好：对称加密的通信双方使用相同的秘钥，如果一方的秘钥泄露，那么整个通信就会被破解。而非对称加密使用一对秘钥，一个用来加密，一个用来解密，而且公钥是公开的，秘钥是自己保存的，不需要像对称加密那样在通信之前要先同步秘钥。非对称加密的缺点是加密和解密花费时间长、速度慢，只适合对少量数据进行加密。

在非对称加密中使用的主要算法有：RSA、Elgamal、背包算法、Rabin、D-H、ECC（椭圆曲线加密算法）等。

### 加密解密技术的应用

加密技术的应用是多方面的，比如电子商务、VPN、数据安全、数字签名和身份认证等。

#### 电子商务

电子商务（E-business）要求顾客可以在网上进行各种商务活动，不必担心自己的信用卡会被人盗用。在过去，用户为了防止信用卡的号码被窃取到，一般是通过电话订货，然后使用用户的信用卡进行付款。现在人们开始用RSA（一种公开/私有密钥）的加密技术，提高信用卡交易的安全性，从而使电子商务走向实用成为可能。

许多人都知道NETSCAPE公司是Internet商业中领先技术的提供者，该公司提供了一种基于RSA和保密密钥的应用于因特网的技术，被称为安全插座层（Secure Sockets Layer，SSL）。

也许很多人知道Socket，它是一个编程接口，并不提供任何安全措施，而SSL不但提供编程接口，而且向上提供一种安全的服务，SSL3.0现在已经应用到了服务器和浏览器上，SSL2.0则只能应用于服务器端。

SSL3.0用一种电子证书（electric certificate）来实行身份进行验证后，双方就可以用保密密钥进行安全的会话了。它同时使用"对称"和"非对称"加密方法，在客户与电子商务的服务器进行沟通的过程中，客户会产生一个Session Key，然后客户用服务器端的公钥将Session Key进行加密，再传给服务器端，在双方都知道Session Key后，传输的数据都是以Session Key进行加密与解密的，但服务器端发给用户的公钥必需先向有关发证机关申请，以得到公证。

基于SSL3.0提供的安全保障，用户就可以自由订购商品并且给出信用卡号了，也可以在网上和合作伙伴交流商业信息并且让供应商把订单和收货单从网上发过来，这样可以节省大量的纸张，为公司节省大量的电话、传真费用。

#### VPN

现在，越来越多的公司走向国际化，一个公司可能在多个国家都有办事机构或销售中心，每一个机构都有自己的局域网LAN（Local Area Network），但在当今的网络社会人们的要求不仅如此，用户希望将这些LAN连结在一起组成一个公司的广域网，这个在现在已不是什么难事了。事实上，很多公司都已经这样做了，但他们一般租用专用线路来连结这些局域网 ，他们考虑的就是网络的安全问题。现在具有加密/解密功能的路由器已到处都是，这就使人们通过互联网连接这些局域网成为可能，这就是我们通常所说的虚拟专用网（Virtual Private Network ，VPN）。当数据离开发送者所在的局域网时，该数据首先被用户端连接到互联网上的路由器进行硬件加密，数据在互联网上是以加密的形式传送的，当达到目的LAN的路由器时，该路由器就会对数据进行解密，这样目的LAN中的用户就可以看到真正的信息了。

#### 数据安全

个人电脑或公司电脑机中的密数据一旦泄密，造成的损失和影响将是巨大的。十分有必要对机密文件进行加密存储。

数字签名就是基于加密技术的，它的作用就是用来确定用户是否是真实的。应用最多的就是电子邮件，如当用户收到一封电子邮件时，邮件上面标有发信人的姓名和信箱地址，很多人可能会简单地认为发信人就是信上说明的那个人，但实际上伪造一封电子邮件对于一个通常人来说是极为容易的事。在这种情况下，就要用到加密技术基础上的数字签名，用它来确认发信人身份的真实性。

类似数字签名技术的还有一种身份认证技术，有些站点提供入站FTP和WWW服务，用户接触的这类服务通常是匿名而不加区分的，这种情况下用户的权力一般会受到限制。这类服务也有非匿名的，现在的问题就是，如何确定正在访问服务器的人就是用户认为的那个人，身份认证技术就是一个好的解决方案。

加密可以用于保证安全性， 但是其它一些技术在保障通信安全方面仍然是必须的，尤其是关于**数据完整性和信息验证**；例如，信息验证码（MAC）或者数字签名。另一方面的考虑是为了应付流量分析。

加密或软件编码隐匿（Code Obfuscation）同时也在软件版权保护中用于对付反向工程，未授权的程序分析，破解和软件盗版及数位内容的数位版权管理 （DRM）等。

### 加密技巧

下面的技巧可强化加密的安全性：

1. 不要使用老的加密算法。企业应当停止使用DES等老的加密算法，也不要使用其亲戚3DES（三重数据加密标准）。
2. 使用企业支持的最长的加密密钥。建议企业尽可能使用最大长度的密钥，这可以使那些无法访问后门的企业难以破解企业的加密。当今，AES 128可谓强健，但如果可能，不妨使用AES 512 或更长的密钥。
3. 多层加密。建议企业尽可能地利用多层加密，这可以增加攻击者的困难。如果有可能，不妨对数据库的每个字段、每个表以及整个数据库都进行加密。
4. 安全存储加密密钥。企业面临的最大问题可能并不是加密算法被美国的国安局留下后门，而是密码本身仅仅是加密方案的一部分。对于基础架构的其它要素，如密钥管理系统，企业也必须保证其安全。攻击者都愿意对付安全系统的最薄弱环节。如果攻击者很容易就可以窃取密钥，为什么还会费力破解加密算法呢？有的企业将保护其数据的密钥给第三方，尤其是在企业将数据存储在公共云中并由云供应商加密和保护时。这里的问题是，企业无法控制密钥，而是必须相信云供应商的雇员会安全地保存密钥。如果企业可以实施一种可以将密钥控制在云中的加密系统，就会安全得多。自动处理加密的云加密网关可以帮助公司实现这种安全。
5. 确保正确实施加密。事实上，实施加密系统并非易事，因为它有许多动态部件，任何一个部件都有可能成为一个薄弱环节。你必须进行大量调查，确保正确实施加密。在实施加密过程中，哪些方面容易出错？除了密钥容易遭受攻击，还有CBC（密码分组链接）的实施方式。使用CBC，可以用同样长度的随机文本块（也称为初始化向量）对纯文本进行异或运算，然后对其进行加密，产生一个加密文本块。然后，将前面产生的密文块作为一个初始化向量对下一个纯文本块进行异或运算。CBC的正确实施要求在开始每个过程时都有一个新的初始化向量。一个常见的错误是用一个不加改变的静态初始化向量来实施CBC。如果正确实施了CBC，那么，如果我们在两个不同的场合加密了文本块，所生产的密文块就不会相同。
6. 不要忽视外部因素。公司几乎无法控制的外部因素有可能破坏加密系统的安全性。例如，SSL依赖于数字证书，而且这些因素依赖于嵌入在浏览器（如IE、火狐、Chrome等）中的根证书颁发机构的完整性。但是，我们如何知道其是否可信，或者这些证书颁发机构不是某外国情报机构的幌子？你是否觉得这听起来牵强附会，但却有可能是事实。此外，DNS也是不得不重视的弱点。只要DNS被攻克，攻击者就可以使用钓鱼技术绕过加密。当然，这里强调的是加密问题的各种可能性。一个正确实施的加密系统只能在一种情况下被攻克，即测中密钥，在短时间内猜对密钥并非不可能，但其可能性微乎其微。