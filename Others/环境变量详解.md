---
typora-copy-images-to: ..\..\graphs\photos
typora-root-url: ./
---

### **环境变量概述**

环境变量（environment variables）一般是指在操作系统中用来指定操作系统运行环境的一些参数，如：临时文件夹位置和系统文件夹位置等。

环境变量是在操作系统中一个具有特定名字的对象，它包含了一个或者多个应用程序所将使用到的信息。例如Windows和DOS操作系统中的path环境变量，当要求系统运行一个程序而没有告诉它程序所在的完整路径时，系统除了在当前目录下面寻找此程序外，还应到path中指定的路径去找。如tc或vc++中，set include=path1;path2; 是告诉编译程序到哪里去找.h类型的文件；当然不仅仅是指定什么路径，还有其它的作用的，如set dircmd=/4 设置一个环境变量的作用是在使用dir命令时会把/4作为缺省的参数添加到你的dir命令之后，就像你的每个命令都加了/4参数，它实际上是给命令解释程序command设置的一个环境变量，并且是给dir这个内部命令设置的。

### **软件共用**

很多朋友会在自己的计算机上安装双系统，例如C盘安装Windows XP，D盘安装Windows 7。可是某些软件往往只在Windows XP系统中安装，Windows 7系统中是无法正常使用的，比较麻烦却有效的方法是再安装一遍。当我们了解了环境变量中的用途后就可以很好解决双系统的软件共用问题。为什么在Windows XP中安装了的软件在Windows 7下无法运行呢(绿色软件除外)?原因是安装软件时往往须要向系统目录中复制某些文件，而使用另外一个系统时会由于缺少这些文件而无法运行。因此，我们可以通过设置环境变量的方法来解决这个问题。

### **环境变量设置**
#### **WINDOWS系统**

- %ALLUSERSPROFILE% 局部 返回所有“用户配置文件”的位置。
- %APPDATA% 局部 返回默认情况下应用程序存储数据的位置。
- %CD% 局部 返回当前目录字符串。
- %CMDCMDLINE% 局部 返回用来启动当前的 Cmd.exe 的准确命令行。
- %CMDEXTVERSION% 系统 返回当前的“命令处理程序扩展”的版本号。
- %COMPUTERNAME% 系统 返回计算机的名称。
- %COMSPEC% 系统 返回命令行解释器可执行程序的准确路径。
- %DATE% 系统 返回当前日期。使用与 date /t 命令相同的格式。由 Cmd.exe 生成。有关 date 命令的详细信息，请参阅 Date。
- %ERRORLEVEL% 系统 返回使用过的命令的错误代码。通常用非零值表示错误。
- %HOMEDRIVE% 系统 返回连接到用户主目录的本地工作站驱动器号。基于主目录值的设置。用户主目录是在“本地用户和组”中指定的。
- %HOMEPATH% 系统 返回用户主目录的完整路径。基于主目录值的设置。用户主目录是在“本地用户和组”中指定的。
- %HOMESHARE% 系统 返回用户的共享主目录的网络路径。基于主目录值的设置。用户主目录是在“本地用户和组”中指定的。
- %LOGONSEVER% 局部 返回验证当前登录会话的域控制器的名称。
- %NUMBER\_OF\_PROCESSORS% 系统 指定安装在计算机上的处理器的数目。
- %OS% 系统 返回操作系统的名称。Windows 2000 将操作系统显示为 Windows\_NT。
- %PATH% 系统指定可执行文件的搜索路径。**由PATH环境变量指定的目录下的命令可以在任意目录中直接使用。**
- %PATHEXT% 系统返回操作系统认为可执行的文件扩展名的列表。
- %PROCESSOR\_ARCHITECTURE% 系统 返回处理器的芯片体系结构。值: x86，IA64。
- %PROCESSOR\_IDENTIFIER% 系统 返回处理器说明。
- %PROCESSOR\_LEVEL% 系统 返回计算机上安装的处理器的型号。
- %PROCESSOR\_REVISION% 系统 返回处理器修订号的系统变量。
- %PROMPT% 局部 返回当前解释程序的命令提示符设置。由 Cmd.exe 生成。
- %RANDOM% 系统 返回 0 到 32767 之间的任意十进制数字。由 Cmd.exe 生成。
- %SYSTEMDRIVE% 系统 返回包含 Windows XP 根目录（即系统根目录）的驱动器。
- %SYSTEMROOT% 系统 返回 Windows XP 根目录的位置。
- %TEMP% and %TMP% 系统和用户 返回对当前登录用户可用的应用程序所使用的默认临时目录。有些应用程序需要 TEMP，而其它应用程序则需要 TMP。
- %TIME% 系统 返回当前时间。使用与 time /t 命令相同的格式。由 Cmd.exe 生成。有关 time 命令的详细信息，请参阅 Time。
- %USERDOMAIN% 局部 返回包含用户帐户的域的名称。
- %USERNAME% 局部 返回当前登录的用户的名称。
- %USERPROFILE% 局部 返回当前用户的配置文件的位置。
- %WINDIR% 系统 返回操作系统目录的位置。

##### **设置方法**

在Windows操作系统中可以通过我的电脑 -> 系统属性 -> 高级系统设置 -> 环境变量，来设置系统的环境变量，然而在此设置的环境变量是否在注册表中具有对应的项呢？答案是肯定的。而在.net 中提供了一个类来获取系统的环境变量及其值。
环境变量分为两类：用户变量与系统变量，在注册表中都有对应的项。
其中用户变量所在位置：
HKEY_CURRENT_USER\Environment；
系统变量所在位置为：\HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001
\Control\Session Manager\Environment。

另外也可以右击我的电脑 -> 系统属性 -> 高级系统设置 -> 环境变量 -> 在系统变量里有Path选项 -> 双击打开 -> 在原有变量的基础上添加英文状态下的分号 ->然后将路径名输入即可。（切记，不要删除原先的系统变量，只要用分号隔开，然后添加，最后也要加上分号）。

Windows平台以Win10为例：
右键此电脑——属性：

![这里写图片描述](http://img.blog.csdn.net/20161126113507516)

高级系统设置：

![这里写图片描述](http://img.blog.csdn.net/20161126114446907)

环境变量： 

![这里写图片描述](http://img.blog.csdn.net/20161126114517127)

用户变量仅对当前的用户有效，系统变量对所有用户有效。考虑到不影响其他用户的使用，这里选择设置用户变量。选中Path（如果没有Path，则选择新建Path）-> 编辑：

![env5.png](appendix\env5.png)

如JDK环境变量的添加如下：

![env6.png](appendix\env6.png)

>注意：Windows下不区分大小写，因此windows与WINDOWS都正确；而Linux系统是严格区分大小写的。

##### **编辑方法**

输入set命令可以查看系统当前所存在的所有的环境变量。从环境变量中我们可以得到很多信息。
例如PROCESSOR\_IDENTIFIER显示处理器的架构，USERDOMAIN显示计算机名，USERNAME显示计算机用户名,TEMP显示系统临时文件夹的位置，PROMPT显示当前提示符的状态灯。

![env.png](appendix\env.png)

也可以查看单个的环境的变量，例如输入set windir显示当前的系统文件夹的位置。输入SET P可以查看所有字母以P开头的环境变量的值。

![env2.png](appendix\env2.png)

也可以自定义环境变量，例如我们输入set aa=%temp%，就代表把临时文件夹的值赋值给aa。环境变量在表示的时候需要用%括起来，以便于和普通的字符区分。我们还可以删除环境变量，例如我们输入set aa= 就可以把我们刚才建立的环境变量删除了。

![env3.png](appendix\env3.png)

有关set命令的其他用法请参考set命令帮助：在命令行输入"set /?"回车即可查看set命令帮助

![env4.png](appendix\env4.png)

>注意：不用担心在DOS窗口的修改会影响我的电脑>属性>高级>环境变量里的修改，因为DOS窗口的环境变量只是Windows环境变量的一个副本，副本的改动不会影响正本，所以在DOS窗口中以set命令行方式对环境变量的操作只对当前窗口的应用有效。要想永久加入环境变量，就要用图形界面操作。 但是DOS窗口的环境变量改动会触发正本（图形界面环境变量的修改）的刷新，这可用于使环境变量的设置立即生效。

#### **Linux系统**

Linux中环境变量也包括系统级和用户级，系统级的环境变量是每个登录到系统的用户都要读取的系统变量，而用户级的环境变量则是该用户使用系统时加载的环境变量。所以管理环境变量的文件也分为系统级和用户级的。

系统级：

- /etc/profile：该文件是用户登录时，操作系统设置用户环境变量时使用的第一个文件，应用于登录到系统的每一个用户。该文件一般是调用/etc/bash.bashrc文件。
- /etc/bash.bashrc：系统级的bashrc文件。
- /etc/environment：在登录时操作系统使用的第二个文件，系统在读取你自己的profile前，设置环境文件的环境变量。

用户级（这些文件处于用户个人目录下，使用 `ls -a` 可以查看到这些文件）：

- ~/.profile：每个用户都可使用该文件输入专用于某个用户使用的shell信息，当用户登录时，该文件仅仅执行一次。默认情况下，该用户设置的一些环境变量,执行用户的.bashrc文件。这里是推荐放置个人环境设置的地方。

- ~/.bashrc：该文件包含专用于某个用户的bash shell的bash信息，**当登录时以及每次打开新的shell时，该该文件都会被读取**。不推荐放到这儿，因为每开一个shell，这个文件会读取一次，效率肯定有影响。

  ~/.bash_profile 或者 ~./bash_login：这里没有引用作者的，下面会提到。

  ~/.pam_environment：用户级的环境变量设置文件，没有做测试，不知道管不管用。

通过上面的文件介绍，就能明白我们需要设置环境变量的时候，需要修改什么文件，要想对所有的用户生效，那就需要设置系统级的环境变量。反之，需要修改用户级的文件（最好是修改.profile文件，理由上面已经讲了）。
另外，我使用的是Ubuntu10.04，之前在查找资料设置用户级环境变量的时候，有资料说要修改~.bash_profile文件，但是在ubuntu10.04系统中是没有该文件。经查找，在ubuntu官网[2]上找到了这个文件的说明：

~/.bash_profile or ~./bash_login - If one of these file exist, bash executes it rather then "~/.profile" when it is started as a login shell. (Bash will prefer "~/.bash_profile" to "~/.bash_login"). However, these files won't influence a graphical session by default.

意思应该是说当这个文件存在时，在登录shell时会读取./bash_profile文件，而不是.profile文件。我认为该文件实现的目的 跟.profile文件是一样的，当查找的资料中需要你修改.bash_profile文件，但却你没有该文件的时候，也可以修改.profile来完成 实现。

[1]http://cab402.appspot.com/2010/05/1/UbuntuEnvironmentVariablesSet.html

[2]https://help.ubuntu.com/community/EnvironmentVariables



Linux下也有临时查看、设置环境变量的命令：export。打开Linux终端命令窗口，输入export命令来查看当前环境变量：

![linux_export](../../graphs/photos/linux_export.png)

为了验证是否修改成功可以再继续输入命令eport进行查看





二、配置环境变量实战

1.配置java环境变量

（1）首先在官方网站上下载jdk安装文件，我下载的为：jdk-7u5-linux-i586.tar.gz，当然也可以下载.bin格式的文件，但是这种文件与本文介绍的tar格式的文件在解压缩方面有所不同，这里不再详细介绍；

（2）解压缩该文件，解压后的文件名为：jdk1.7.0_05；将其拷贝到一个文件目录，我放入的是：/home/stopit/software目录，所以当前jdk路径为/home/stopit/software/jdk1.7.0_05，这里将/home/stopit/software/jdk1.7.0_05用xxx替代；

（3）根据上文介绍的几个linux环境变量文件，我们选择profile文件写入我们的环境变量；使用 suodo gedit /etc/proifle  命令打开该文件，并输入以下命令：

```shell
#修改java运行环境
export JAVA_HOME="/usr/java/jdk1.8.0_131"
export PATH="$PATH:$JAVA_HOME/bin"
export JRE_HOME="$JAVA_HOME/jre"
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar "
```

（4）修改完成后，使用source /etc/profile 命令进行更新；

（5）下面这几步比较重要，因为在许多linux系统中都预装了openjdk，所以即使上面进行了这些设置，系统默认的还不是我们要设置的内容；如果要真正使用我们自己的jdk，还需要一下步骤：

sudo update-alternatives --install /usr/bin/java java xxx/bin/java 300

sudo update-alternatives --install /usr/bin/javac javac xxx/bin/javac 300

(这里的300只是标识一下，没什么意义，只是下一步要用到)

 

sudo update-alternatives --config java

执行这步会列出系统上的所有已安装的java，然后自己选择，即选最后为300的那个

sudo update-alternatives --config javac

同上

注意：有些文章上说仅仅使用一下语句即可：
sudo update-alternatives –config java，笔者没有尝试过！

（6）大功告成，使用java -version 命令来查看我们的java环境变量，显示如下内容：

java version "1.7.0_05"
Java(TM) SE Runtime Environment (build 1.7.0_05-b06)
Java HotSpot(TM) Server VM (build 23.1-b03, mixed mode)

2.配置tomcat环境变量

（1）从官方网站上下载tomcat软件包。

http://tomcat.apache.org/

点击左侧的 download的一个版本，我选择的是 tomcat6.x,你可以根据自己的实际情况进行选择安装，点击超连接，选择 Binary Distributions 下的tar.gz (pgp, md5) 压缩包，进行下载

（2）下载到本地后，进行解压

\#tar zxvf apach-tomcat-6.0.16.tar.gz

\#mv apach-tomcat-6.0.16 /usr/local

（3）进行tomcat环境的配置(前提需要安装jdk)

sudo geidt /etc/profile

输入以下内容

export TOMCAT_HOME=xx

xx同上，为你的tomcat安装路径

保存退出

 

（4）# source /etc/profile //让当前配置立即生效

 

（5）启动tomcat服务器，运行如下内容

sudo xx/bin/startup.sh

注：（不可手动双击文件下的startup.sh执行），暂时不知是否可行

我的电脑上会出现如下内容：

Using CATALINA_BASE: /usr/local/apache-tomcat-6.0.16

Using CATALINA_HOME: /usr/local/apache-tomcat-6.0.16

Using CATALINA_TMPDIR: /usr/local/apache-tomcat-6.0.16/temp

Using JRE_HOME: /usr/local/jdk1.6.0_04

（6）在浏览器中输入http://localhost:8080/就可以看到tomcat的log了

tomcat的安装到此结束。

（7）如果遇到问题可参考：http://forum.ubuntu.org.cn/viewtopic.php?t=183813

 

 

 

（8）后续配置：

——停止Tomcat服务 
$sudo /opt/tomcat/bin/shutdown.sh

——获得MySQL的JDBC，在Firefox浏览器的地址栏中输入http: //dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-3.1.10.tar.gz/from/http: //mysql.cbn.net.id/以得到该软件。 

——安装JDBC 
$tar -zxvf mysql-connector-java-3.1.10.tar.gz 
$sudo cp mysql-connector-java-3.1.10/mysql-connector-java-3.1.10-bin*.jar /usr/lib/j2sdk1.5-sun/lib
——配置Tomcat的端口
Ubuntu自带的Tomcat打开的是8180端口，既不符合常规，也不利于使用。我们可以做一些简单的修改，让Tomcat使用其他的端口进行服务。在Terminal中，输入
sudo gedit /usr/share/tomcat5/conf/server.xml
在配置文件中查找
<Connector className="org.apache.coyote.tomcat5.CoyoteConnector" port="8180"
并把其中的8180替换成需要的端口。一般情况下，可以替换成80或者是8080。如果设置成80，那么在浏览器中直接输入http://localhost就可以访问到Tomcat的页面。 重新启动Tomcat生效。
——设置Tomcat管理员帐号
Tomcat的用户帐号信息都保存在tomcat-users.xml的文件中，运行
sudo gedit /usr/share/tomcat5/conf/tomcat-users.xml
在</tomcat-users>的标签前添加一行
<user username="用户名" password="密码" roles="admin,manager"/>
保存并关闭。重新运行tomcat即可输入该用户名和密码，登录Tomcat的管理页面。
——安装最新版本的Tomcat
我们接下来介绍直接从Apache Tomcat的主页上下载并使用最新版本5.5.17的Tomcat软件，该方法方便快捷而且并不影响系统的稳定性。
从tomcat的官方下载页面http://tomcat.apache.org/download-55.cgi
下载Binary->Core分类中的zip或者tar.gz包后，本地解压缩并将新生成的目录重命名为tomcat，以方便使用。将这个文件夹移动至某路径PATH/。 参考以上设置环境变量和端口设置等步骤，大功告成！ 直接运行
PS,开始的时候用apt-get安装tomcat5.5,总是出现无法安装成功,在shutdown时,出来java异常,最后实在没有办法了,用
sudo apt-get remove tomcat5.5
把它给卸载了.重新下载安装,不用apt-get







shell环境依赖于多个文件的设置。当shell被调用时，它从两个初始文件读取命令。**/etc/profile包含了系统变量，它由系统管理员维护，由系统管理员设置本地系统变量和特殊命令。普通用户的启动信息文件($HOME/.bash_project)由各用户自己维护，该文件可以被修改以实现任何特定的系统初始化**。

只有在特定的情况下才读取profile文件，确切的说是在用户登陆的时候。当运行shell脚本或subshell以后，就无须再读profile。虽然所有profile都可选的，但是基本上所有系统都有/etc/profile。

如果定义了变量ENV且已经传递到环境中，则所有的bash shell都要读取并调用由这个变量制定的文件所包含的命令。这个文件用来定义所有bash shell的特征，而不仅仅是登陆到shell。这个文件的典型的名字是$HOME/,bashrc。

当用（系统管理员）新建用户时，.bash_profile、bashrc和其他公共的环境文件模板将复制到/etc/skel这个目录下面。可以编辑这些初始化设置，也可以在此目录下添加附加的文件。

Example：
一个典型的系统profile(/etc/profile):
```shell
PATH=$PATH:/usr/qa/tools/bin
ENV==$HOME/.bashrc
ORACLE_HOME=/dbs/oracle
ORACLE_SID=qadb
Export PATH ENV ORACLE_HOME ORCAL_SID
Cat /etc/motd
```
一个典型的用户profile(.bashrc)
```shell
PATH=$PATH:$HOME/bin
TEAM=uvt1224 export TERM
sttyintr \^C
cal
mesg n
```
一个典型的用户 bashrc file (.bashrc):
```shell
alias dir=ls lf='ls -FC'
PSI='$PWS[!]>'
set -o vi
```
别名和其他bash专用的定义应该放在.bashrc文件（不应在.bash_profile) 中定义；否则会导致找不到某些命令。
应该记住profile文件和.bashrc文件的区别：两个profile都只在系统启动时被读取一次，而.bashrc在系统启动和每次调用shell的时候都要被读取。
